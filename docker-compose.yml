#
# Notes:
#
# The following variables must be set in the shell that docker-compose
# is executed from:
#
# SLACK_API_TOKEN

postgres:
  image: postgres:9.5
  # environment:
  #   - POSTGRES_USER=${POSTGRES_USER}
  #   - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
cog:
  image: 2ba2e73c6b43
  environment:
    - COG_MQTT_HOST=0.0.0.0
    - DATABASE_URL=ecto://postgres:@localhost:5432/cog
    - COG_ADAPTER=slack
    - SLACK_API_TOKEN=${SLACK_API_TOKEN}
    # - HIPCHAT_API_TOKEN=${HIPCHAT_API_TOKEN}
    # - HIPCHAT_MENTION_NAME=${HIPCHAT_MENTION_NAME}
    # - HIPCHAT_XMPP_NICKNAME=${HIPCHAT_XMPP_NICKNAME}
    # - HIPCHAT_XMPP_SERVER=${HIPCHAT_XMPP_SERVER}
    # - HIPCHAT_XMPP_ROOMS=${HIPCHAT_XMPP_ROOMS}
    # - HIPCHAT_XMPP_PORT=${HIPCHAT_XMPP_PORT}
    # - HIPCHAT_XMPP_JID=${HIPCHAT_XMPP_JID}
    # - HIPCHAT_XMPP_PASSWORD=${HIPCHAT_XMPP_PASSWORD}
  links:
    - postgres:localhost
  ports:
    - 80:4000
    - 1883
  entrypoint: /home/operable/cog/scripts/docker-start
